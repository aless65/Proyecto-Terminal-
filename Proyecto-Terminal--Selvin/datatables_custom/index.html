<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="#" />
    <title>Tutorial DataTables</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <!-- CSS personalizado -->
    <link rel="stylesheet" href="main.css">

    <!--datables CSS básico-->
    <link rel="stylesheet" type="text/css" href="datatables/datatables.min.css" />
    <!--datables estilo bootstrap 4 CSS-->
    <link rel="stylesheet" type="text/css" href="datatables/DataTables-1.10.18/css/dataTables.bootstrap4.min.css">

    <!--font awesome con CDN-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>

</head>

<body>
    <header>
        <h1 class="text-center text-light">DATATABLES</h1>
        <h2 class="text-center text-light">Cómo <span class="badge badge-warning">Personalizar</span></h2>
    </header>
    <div style="height:50px"></div>

    <!--Ejemplo tabla con DataTables-->
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive">
                    <td><button onclick="mostrarPdf('blob:null/2b62c1ef-d5ee-4f46-aede-7aec94ec17ae')">Ver PDF</button>
                    </td>
                    <div class="col-sm-6 text-right"><a class="btn btn-success" id="exportForm">Export page</a></div>

                    <div id="first-page">
                        <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Puesto</th>
                                    <th>Ciudad</th>
                                    <th>Año de Ingreso</th>
                                    <th>Salario</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Tiger Nixon</td>
                                    <td>Arquitecto</td>
                                    <td>Edinburgh</td>
                                    <td>2011/04/25</td>
                                    <td>$320,800</td>
                                </tr>
                                <tr>
                                    <td>Garrett Winters</td>
                                    <td>Contador</td>
                                    <td>Tokyo</td>
                                    <td>2011/07/25</td>
                                    <td>$170,750</td>
                                </tr>
                                <tr>
                                    <td>Cedric Kelly</td>
                                    <td>Senior Javascript Developer</td>
                                    <td>Edinburgh</td>
                                    <td>2012/03/29</td>
                                    <td>$433,060</td>
                                </tr>
                                <tr>
                                    <td>Jonas Alexander</td>
                                    <td>Developer</td>
                                    <td>San Francisco</td>
                                    <td>2010/07/14</td>
                                    <td>$86,500</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div>

                <iframe id="pdf-preview" width="700px" height="600px"></iframe>

                <iframe src="DataTables example - PDF - image (1).pdf" style="width: 600px; height: 500px;" frameborder="0"></iframe>

            </div>
        </div>
    </div>

    <iframe id="miIframe" width="100%" height="500"></iframe>

    <!-- jQuery, Popper.js, Bootstrap JS -->
    <script src="jquery/jquery-3.3.1.min.js"></script>
    <script src="popper/popper.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>

    <!-- datatables JS -->
    <script type="text/javascript" src="datatables/datatables.min.js"></script>

    <!-- para usar botones en datatables JS -->
    <script src="datatables/Buttons-1.5.6/js/dataTables.buttons.min.js"></script>
    <script src="datatables/JSZip-2.5.0/jszip.min.js"></script>
    <script src="datatables/pdfmake-0.1.36/pdfmake.min.js"></script>
    <script src="datatables/pdfmake-0.1.36/vfs_fonts.js"></script>
    <script src="datatables/Buttons-1.5.6/js/buttons.html5.min.js"></script>

    <!-- código JS propìo-->
    <script type="text/javascript" src="main.js"></script>

    <script>
        /*
                function mostrarPdf(rutaPdf) {
                    var iframe = document.getElementById('miIframe');
                    iframe.setAttribute('src', rutaPdf);
                }

                $(".btn btn-secondary buttons-pdf buttons-html5").click(function () {

                    console.log("le diste click");

                });


                $('#exportForm').click(function () {
            console.log("L");

                var pdf = new jsPDF('a', 'mm', 'a4');
                var firstPage;
                var secondPage;
         
                html2canvas($('#first-page'), {
                    onrendered: function (canvas) {
                        firstPage = canvas.toDataURL('image/jpeg', 1.0);
                    }
                });
         
                
                setTimeout(function () {
                    pdf.addImage(firstPage, 'JPEG', 5, 5, 200, 0);
                    pdf.save("Exporat.pdf");
                }, 150);
            });
        */
        const tableData = getDataTable();

        // Crear un nuevo objeto jsPDF y agregar los datos de la tabla al PDF
        const pdf = new jsPDF();
        pdf.text(20, 20, 'Datos de la tabla:');
        pdf.autoTable({
            html: '#my-table'
        });

        // Crear un objeto URL para la vista previa del PDF
        const pdfBlob = pdf.output('blob');
        const pdfUrl = URL.createObjectURL(pdfBlob);

        // Obtener el elemento iframe y establecer su src a la vista previa del PDF
        const iframe = document.getElementById('pdf-preview');
        iframe.src = pdfUrl;
    </script>

</body>

</html>